<!DOCTYPE html>
<html>

<head>
    <script data-require="snap.svg@0.3.0" data-semver="0.3.0"
        src="//cdn.jsdelivr.net/snap.svg/0.5.1/snap.svg-min.js"></script>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <script>

function createSchematic(numCDBRs) {
    var rectWidth = 80;
    var rectHeight = 120;
    var cornerRounding = 8;
    var strokeWidth = 2;
    var zeroPointX = strokeWidth + rectWidth / 2;
    var zeroPointyY = strokeWidth;

    var s = Snap(rectWidth * 2 * (numCDBRs + 1), 1000);

    // Get middle of bottom of rect
    function mb(rect) {
        var bbox = rect.getBBox();
        var coordinates = {
            x: bbox.x + bbox.width / 2,
            y: bbox.y + bbox.height
        };
        return coordinates;
    }

    // Get middle of top of rect
    function mt(rect) {
        var bbox = rect.getBBox();
        var coordinates = {
            x: bbox.x + bbox.width / 2,
            y: bbox.y
        };
        return coordinates;
    }

        // Get middle of the left side of rect
        function ml(rect) {
        var bbox = rect.getBBox();
        var coordinates = {
            x: bbox.x,
            y: bbox.y + bbox.height /2,
        };
        return coordinates;
    }

        // Get middle of the right side of rect
        function mr(rect) {
        var bbox = rect.getBBox();
        var coordinates = {
            x: bbox.x + bbox.width,
            y: bbox.y + bbox.height /2,
        };
        return coordinates;
    }

    // Create the first rectangle (CR700)
    var CR700 = s.rect(zeroPointX + (rectWidth * (numCDBRs - 1)), zeroPointyY, rectWidth, rectHeight, cornerRounding, cornerRounding).attr({
        fill: "transparent",
        stroke: "#005BBB",
        strokeWidth: strokeWidth
    });

    // Function to create multiple CDBR rectangles
    var spacing = rectWidth + rectWidth; // Adjust spacing as needed
    var startX = zeroPointX;

    for (var i = 0; i < numCDBRs; i++) {
        var x = startX + i * spacing;
        var CDBR = s.rect(x, zeroPointyY + rectHeight * 2, rectWidth, rectHeight, cornerRounding, cornerRounding).attr({
            fill: "transparent",
            stroke: "#747678",
            strokeWidth: strokeWidth
        });

        // Draw right-angle line connecting CR700 to each CDBR
        var cr700Bottom = mb(CR700);
        var cdbrTop = mt(CDBR);

        // Calculate the midpoints for the bend
        var midX = cr700Bottom.x;
        var midY = (cr700Bottom.y + cdbrTop.y) / 2;

        s.path(`M${cr700Bottom.x},${cr700Bottom.y} V${midY} H${cdbrTop.x} V${cdbrTop.y}`).attr({
            stroke: "black",
            strokeWidth: 1,
            fill: "none"
        });

        // Create a resistor centered under each CDBR
        var smallRectWidth = rectWidth / 1.6;
        var smallRectHeight = rectHeight / 4;
        var smallRectX = x + (rectWidth - smallRectWidth) / 2;
        var smallRectY = zeroPointyY + rectHeight * 3  + rectHeight / 3;

        resistor = s.rect(smallRectX, smallRectY, smallRectWidth, smallRectHeight).attr({
            fill: "transparent",
            stroke: "#616365",
            strokeWidth: strokeWidth
        });


        // Add lines to connect resistor

        startB1LineX = mb(CDBR).x - rectWidth * (1/6);
        startB1LineY = mb(CDBR).y;

        s.path(`M${startB1LineX},${startB1LineY} v${((mt(resistor).y) - mb(CDBR).y)/2} h${-rectWidth/2} V${ml(resistor).y} H${ml(resistor).x}` ).attr({
            stroke: "black",
            strokeWidth: 1,
            fill: "none"
        });

        startB2LineX = mb(CDBR).x + rectWidth * (1/6);
        startB2LineY = mb(CDBR).y;

        s.path(`M${startB2LineX},${startB2LineY} v${((mt(resistor).y) - mb(CDBR).y)/2} h${rectWidth/2} V${ml(resistor).y} H${ml(resistor).x + smallRectWidth}` ).attr({
            stroke: "black",
            strokeWidth: 1,
            fill: "none"
        });
    }
}

// Example usage: create 4 CDBR rectangles
createSchematic(3);





    </script>
</body>

</html>